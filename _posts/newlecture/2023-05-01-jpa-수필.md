---
title: JPA
tags: 
---

mybatis는 dao 인터페이스와 씨퀄을 연동시켜주니 dao 구현됨
jpa는 entity와 데이터베이스 테이블(DB Entity) 연동해주니 dao 구현됨

JPA는 쿼리는 단순하게 하고 ajax로 도배하겠다라고 할 때 사용. 쿼리가 간단할 때 사용.
jpa를 쓰려면 native 쿼리를 쓰면 안된다. 객체기반으로 쓰자. DBMS를 생각하고 작성하는 게 아니다.
Mybatis는 동적 쿼리, 조인할 때 사용. 쿼리가 복잡할 때 사용

## ORM과 JPA with ...

O(Entity object)RM을 지원하는 persistance framework 라이브러리 중 하나다

원래 ORM은 원래 씨퀄, DB를 신경쓰지 않아야하나 자바는 아직 불완전하다.

ORM의 표준 기술 JPA

JPA를 통해 Hibernate를 사용. Hibernate는 실제로 구동되는 놈.

Mybatis는 구현해야할 함수를 갖고있는 인터페이스(dao)와 쿼리를 매핑한 거다. 매핑 정보만 주면 dao를 구현해 준다. mapper tool.

Jpa는 Object와 table을 매핑한 것이다. 이 과정에서 dao와 쿼리문도 만들어 준다.

Mybatis 보다 좀 더 편하다. 매퍼를 만드는 과정이 생략된다. 하지만 쿼리문이 복잡해진다면 불편하다.

## 설치

jdbc api
spring data jpa
spring data jdbc 트랜잭션 처리를 위해
Maria DB 내 db 드라이버

설치가 됐다면 entity 객체에 @Entity를 붙인다. 식별자 표시를 해줘야 한다. @Id붙인다.
DB의 컬럼명과 변수명을 맞춰줘야 한다. 대소문자도 맞춰줘야 한다.

```java
@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder
@Entity
public class Member {
    @Id
    private int id;
    private String userName;
    private String password;
    private String mail;
}
```

dao는 다음과 같이 구현
뻔한 기능은 이미 다 구현되어있다 에) findId, findById 등...

```java
public interface MemberRepository extends JpaRepository<Member, Integer> {
}
```

## JPL

Mybatis 초기 처럼 인터페이스에 쿼리문을 쓰고 있다.
여기서 from member where 는 씨퀄이 아니라 jpa가 제공하는 것이다.

```java
public interface MemberRepository extends JpaRepository<Member, Integer>{
    
    @Query("from Member where userName = :username")
    Member findByUserName(String username);

}
```

사용자 커스텀 메소드는 쿼리문을 직접 만들어야 한다.

위 예제에서 :username 과 userName는 소대문자 일치해야 한다.
form member는 Object Member와 소대문자 일치해야 한다.
where username은 Object Member의 속성 userName과 소대문자 일치해야 한다.

```java
@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder
@Entity
public class Member {
    @Id
    private int id;
    @Column(name = "username")
    private String userName;
    private String pwd;
    private String email;
}
```

속성명 userName에 카멜표기법을 사용하면 DB에서 user_name을 찾는다 하지만 DB의 컬럼명이 username이라면 위와 같이 @Colnmn을 써서 표시해 줘야 한다.