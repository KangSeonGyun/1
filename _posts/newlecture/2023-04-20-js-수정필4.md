---
title: js dom
tags: 
---

node란? 문서를 구성하는 모든 객체

주석 속성(class="")도 노드다

미리 숨겨둔 모달은 클래스 하나를 변수화해서 보였다 안보였다 하면된다. 모달을 숨겨놓으면 사용하지 않더라도 자원을 잡아먹는다.
모달을 만들어야 한다면? Vuejs 등을 사용하더라도 DOM을 써야한다.

```js
```



## 노드 선택

참고 html

```html
    <section id="s1" class="section1">
        <h1 class="aaa">문서</h1>

        <div>
            <button class="btn-up">위</button>
            <button class="btn-down">아래</button>
        </div>

        <ul>
            <li class="current">a</li>
            <li>b</li>
            <li>c</li>
            <li>d</li>
            <li>e</li>
        </ul>
    </section>
```

html에서 hello를 작성하는 것과 아래 코드로 hello를 작성하는 것은 같다.

```js
let node = document.createTextNode("hello");
document.body.append(node);
```

document 객체를 이용한 선택 - id 또는 tagName
documemt 객체를 이용할 때는 섹션이나 컴포넌트 단위를 선택할 때 유용하다

```js
let s1 = document.getElementById("s1");
let s = document.getElementsByTagName("section");
let sc = document.getElementsByClassName("section1")

console.log(s1);
console.log(s);
console.log(sc);
```

document 객체를 이용해서 선택한 컴포넌트의 하위 자식을

```js
```

아래 코드에서 first, last를 선택할 때 위 방법보다 아래 방법이 바람직하다.

```js
let s1 = document.querySelector("section");
let first = s1.querySelector("ul>li:first-child");
let last = s1.querySelector("ul>li:last-child");

let ul = s1.querySelector("ul");
let first = ul.querySelector("li:first-child");
let last = ul.querySelector("li:last-child");
```

Selecters API를 이용하면 css선택자를 사용할 수 있다

```js
let s1 = document.querySelector("#s1");
let first = s1.querySelector("li:first-child");
```

노드 삭제

```js
first.parentNode.removeChild(first); // node 인터페이스에 있는 기능
first.remove(); // Element 인터페이스에 있는 기능
```

노드 추가
아래와 같이 "c"를 추가하면 ul의 li에 감싸지지 않고 들어간다.

```js
let s1 = document.querySelector("section");

let txt = document.createTextNode("c");
let ul = s1.querySelector("ul");
ul.appendChild(txt);
```

아래와 같이 수정하면 ul의 li태그에 "c"가 들어간다

```js
let s1 = document.querySelector("section");

let ul = s1.querySelector("ul");
let li = document.createElement("li");
let txt = document.createTextNode("c");

ul.appendChild(li);
li.appendChild(txt); // appendChild() - Node 인터페이스에 정의되어 있는 기능

ul.append(li); 
li.append(txt); // append() - Element 인터페이스에 정의되어 있는 기능
```

노드 변경
last를 first 위치로 옮기는? 코드?
first는 사라지며 last로 덮어 씌어진다

```js
ul.replaceChild(last, first);
```

## 노드 조작을 위한 예제

current.nextSibling 모든 노드를 대상으로 한다. Node 인터페이스
current.nextElementSibling Element만을 대상으로 한다. Element 인터페이스 기능

up, down 버튼을 클릭하면 current li가 움직이는 기능

```js
let s1 = document.querySelector("#s1");
let ul = s1.querySelector("ul");

let btnUp = s1.querySelector(".btn-up");
let btnDown = s1.querySelector(".btn-down");

let current = ul.querySelector(".current");

btnUp.onclick = function(){
    let next = current.previousElementSibling;
    current.insertAdjacentElement("afterend", next)
}

btnDown.onclick = function(){
    let next = current.nextElementSibling;
    current.insertAdjacentElement("beforebegin", next)
}
```

다른 예제 참고 html

```html
    <section class="s2">
        <h1>이미지목록</h1>
        <style>
            .s2 ul {
                padding: 0;
                list-style-type: none;
            }

            .s2 span {
                display: inline-flex;
                width: 100px;
                height: 100px;
                align-items: center;
                justify-content: center;
                color: white;
                font-weight: bold;
                background-color: blue;
            }
        </style>
        <ul>
            <li><span class="current">1</span></li>
            <li>
                <div>
                    <span>2</span>
                </div>
            </li>
            <li><span>3</span></li>
            <li><span>4</span></li>
        </ul>
    </section>
```

공통 사용 변수 정의

```js
let s2 = document.querySelector(".s2");
let ul = s2.querySelector("ul");
let lis = ul.querySelectorAll("li");
let current = ul.querySelector("li .current");
```

나는 클릭했을 때 li를 선택해 span 배경색을 red로 바꾸고싶다
하지만 아래와 같이 하면 문제가 있다.
정상적으로 작동하지만 span 태그가 선택되어 span이 바뀌었다

```js
for (let li of lis)
    li.onclick = function (e) {
       current = e.target;
       current.style.backgroundColor = "red"
    }
```

이젠 li태그가 선택되지만 li태그의 배경만 바뀌지 span태그의 배경색이 바뀌진 않는다.

```js
for (let li of lis)
    li.onclick = function (e) {
       current = e.target.parentElement;
       current.style.backgroundColor = "red"
    }
```

이렇게 하면 li가 선택되고 span의 배경이 바뀐다
하지만 ul의 구조가 바뀔 가능성이 있다면 문제가 있다.
span이 li의 첫 번째 자식이 아니라 자식의 자식일 수도 있는 것이다.

```js
for (let li of lis)
    li.onclick = function (e) {
       current = e.target.parentElement;
       current.firstElementChild.style.backgroundColor = "red";
    }
```

이젠 li의 자식의 자식이 다른 것이여도 span의 배경이 바뀐다

```js
for (let li of lis)
    li.onclick = function (e) {
        current = e.target.parentElement;

        while (current.tagName !== "LI")
            current = current.parentElement;

        let span = current.firstElementChild;
        while (span.tagName !== "SPAN")
            span = span.firstElementChild;

        span.style.backgroundColor = "red"
        console.log(current);
    }
```

하지만 이렇게 스타일을 주는 것은 바람직 하지 않으므로 미리 클래스를 정의해두고 스타일을 줘야한다.

```html
.s2 li.current span
{
	background-color: red;
}
```

첫 번째 li에 있는 class="current"도 제거해야 한다.

```html
<li><span>1</span></li>
```

li에 스타일 class 주는 방법

```js
for (let li of lis)
    li.onclick = function (e) {

        current = e.target.parentElement;
        while (current.tagName !== "LI")
            current = current.parentElement;

        current.classList.toggle("current");
    }
```

여기서 두 번째 클릭이 왔을 때 이미 클릭된 li와 자리를 바꾸고 싶다

```js
for (let li of lis)
    li.onclick = function (e) {
        // if (current) {
        //     let pre = current.previousElementSibling

        //     e.target.parentElement.replaceWith(current);

        //     if (pre)
        //         pre.after(e.target.parentElement);
        //     else
        //         ul.prepend(e.target.parentElement);

        //     console.log(pre);

        //     return;
        // }

        if (current) {
            console.log("두 번째 선택입니다.");

            //current<->selected
            // 1. 현재 2번째 선택된 엘리먼트 얻기
            let selected = e.target.parentElement;
            while (selected.tagName !== 'LI')
                selected = e.parentElement;

            let selectedBefore = selected.previousElementSibling;
            current.replaceWith(selected);
            if (selectedBefore)
                selectedBefore.after(current);
            else
                ul.prepend(current);

            current.classList.remove("current");
            current = null;

            return;
        }

        // 모든 li를 for문으로 돌면서 current 클래스가 있는지 확인하는 것 보단 current로 바로 하는 게 바람직하다.

        current = e.target.parentElement;
        while (current.tagName !== "LI")
            current = current.parentElement;

        current.classList.toggle("current");
        console.log(current);

        console.log
    }
```



## 갑분 CSS

transform, transition

transform - 다른 요소에 영향을 주지 않고 사이즈를 늘릴 수 있다
border 때문에 다른 요소가 밀릴 수 있으니 box-sizing 설정 필요

transition - transform이 변할 때 0.5초간 서서히 변한다

```css
            .s2 li.current span {
                background-color: red;

                border: 3px solid yellow;
                box-sizing: border-box;
                transform: scale(1.2, 1.2);

                transition: 0.5s;

                animation-name: zoomin;
                animation-duration: 1s;
            }
```

animation zooin을 만들었다

```css
            @keyframes zoomin {
                from {
                    transform: scale(1, 1);
                }

                to {
                    transform: scale(1.2, 1.2);
                }
            }
```

사용방법
name - 사용할 애니메이션 이름
duration - 시간
iteration-count - 반복 횟수
direction - 방향

```css
            .s2 li.current span {
                background-color: red;

                border: 3px solid yellow;
                box-sizing: border-box;

                animation-name: zoomin;
                animation-duration: 0.5s;
                animation-iteration-count: infinite;
                animation-direction: alternate;
            }
```